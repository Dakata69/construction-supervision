# Въведение и общ преглед на проекта

## Какво е този проект?

Това е **Система за Строителен Надзор** - уеб приложение, което помага на строителни фирми и консултанти да управляват своите проекти и да генерират официални документи автоматично.

### Какво прави системата?

1. **Управление на строителни обекти** - създаване, редактиране, проследяване на напредък
2. **Автоматично генериране на актове** - Акт 7, Акт 14, Акт 15 (официални строителни документи)
3. **Съхранение на документи** - всички документи са на едно място
4. **Управление на екипи** - служители, клиенти, проекти

### За кого е тази система?

- **Строителни фирми** - управление на обекти и документация
- **Консултанти по строителен надзор** - генериране на актове и отчети
- **Проектанти** - проследяване на проекти
- **Администратори** - контрол над цялата система

---

## Как работи системата? (Опростено)

Представете си системата като два компонента, които си говорят:

### 1. Frontend (Клиентска част) - Това, което виждате
- **Технология**: React (JavaScript библиотека за потребителски интерфейс)
- **Какво прави**: Показва страниците, формите, бутоните
- **Къде работи**: Във вашия браузър (Chrome, Firefox, Edge)
- **Порт**: 5173 или 5174

### 2. Backend (Сървърна част) - Мозъкът на системата
- **Технология**: Django (Python framework)
- **Какво прави**: Обработва данни, генерира документи, съхранява информация
- **Къде работи**: На сървър (локално или в облак)
- **Порт**: 8000

### Как си комуникират?

```
┌─────────────────┐         HTTP заявки (API)         ┌─────────────────┐
│                 │  ────────────────────────────────> │                 │
│   FRONTEND      │                                    │    BACKEND      │
│  (React)        │  <────────────────────────────────  │   (Django)      │
│  В браузъра     │         JSON отговори              │   На сървър     │
└─────────────────┘                                    └─────────────────┘
                                                               │
                                                               │ Съхранява данни
                                                               v
                                                       ┌─────────────────┐
                                                       │    DATABASE     │
                                                       │   (SQLite/      │
                                                       │   PostgreSQL)   │
                                                       └─────────────────┘
```

**Пример за комуникация:**
1. Потребител натиска бутон "Генерирай Акт 14" във frontend
2. Frontend изпраща HTTP заявка към backend: "Моля, генерирай документ с тези данни..."
3. Backend обработва заявката, създава Word файл, записва го
4. Backend връща отговор: "Готово! Ето линк към файла..."
5. Frontend показва линк за изтегляне на документа

---

## Структура на проекта (Какво къде се намира)

```
construction-supervision/           ← Главна папка на проекта
│
├── backend/                        ← Сървърна част (Django)
│   ├── config/                    ← Настройки на проекта
│   ├── core/                      ← Основен код
│   ├── media/                     ← Файлове (шаблони, генерирани документи)
│   ├── manage.py                  ← Команден инструмент на Django
│   └── requirements.txt           ← Списък с нужни Python библиотеки
│
├── frontend/                       ← Клиентска част (React)
│   ├── src/                       ← Код на приложението
│   ├── public/                    ← Публични файлове
│   ├── package.json               ← Списък с нужни JavaScript библиотеки
│   └── vite.config.ts             ← Конфигурация на build tool
│
├── scripts/                        ← Помощни скриптове
├── DOCS/                          ← Документация (този файл е тук)
└── README.md                      ← Основна информация

```

---

## Използвани технологии

### Backend технологии

| Технология | Версия | За какво служи |
|-----------|---------|----------------|
| **Python** | 3.8+ | Програмен език за backend |
| **Django** | 5.2.8 | Web framework (основа на backend) |
| **Django REST Framework** | 3.15.2 | Създава API endpoints |
| **python-docx** | 1.2.0 | Създава Word документи |
| **SQLite/PostgreSQL** | - | База данни за съхранение |
| **django-cors-headers** | 4.6.0 | Позволява frontend да говори с backend |

**Обяснение на термините:**
- **Framework** = готова основа, която улеснява разработката
- **API** = начин приложенията да си говорят помежду си
- **База данни** = място за съхранение на данни (като Excel, но много по-мощно)

### Frontend технологии

| Технология | Версия | За какво служи |
|-----------|---------|----------------|
| **React** | 18.3.1 | Библиотека за потребителски интерфейс |
| **TypeScript** | 5.6.3 | JavaScript + типове (по-безопасен код) |
| **Vite** | 6.0.3 | Build tool (компилира и стартира кода) |
| **Ant Design** | 5.22.5 | Готови UI компоненти (бутони, форми и т.н.) |
| **Redux Toolkit** | 2.5.0 | Управление на състояние (кой е логнат, какви данни има) |
| **Axios** | 1.7.9 | Комуникация с backend (HTTP заявки) |
| **styled-components** | 6.1.13 | Стилизиране на компоненти |
| **dayjs** | 1.11.13 | Работа с дати |

**Обяснение:**
- **TypeScript** = JavaScript, но с проверка на типовете (като проверка на правописа)
- **Redux** = централно място за данни, достъпно навсякъде
- **Axios** = библиотека за изпращане на заявки към backend

---

## Как работи една типична операция? (Пример)

### Сценарий: Потребител генерира Акт 14

#### Стъпка 1: Потребителят попълва форма
```
Място: frontend/src/pages/Documents.tsx
Какво се случва: 
- Потребителят вижда форма с полета (име на проект, дата и т.н.)
- Попълва полетата
- Натиска бутон "Генерирай Акт 14"
```

#### Стъпка 2: Frontend изпраща данни към Backend
```javascript
// frontend/src/pages/Documents.tsx (около ред 250)

const generateAct14 = async () => {
  // Събира данните от формата
  const data = {
    template_name: 'act14_bg.docx',
    context: {
      project_name: 'Жилищна сграда',
      act_date: '28.11.2025',
      client_name: 'Строй ЕООД'
      // ... други полета
    }
  };
  
  // Изпраща POST заявка към backend
  const response = await api.post('/documents/generate/', data);
  
  // Получава отговор с линк към файла
  console.log(response.data.file_docx); // URL към документа
};
```

#### Стъпка 3: Backend получава заявката
```
Място: backend/core/views/document.py (generate_document_view функция)
Какво се случва:
- Django получава HTTP POST заявка на адрес /api/documents/generate/
- Извиква функция generate_document_view()
- Проверява дали потребителят има права (IsEmployeeOrAdmin)
```

#### Стъпка 4: Backend генерира документа
```python
# backend/core/views/document.py

@api_view(['POST'])
@permission_classes([IsEmployeeOrAdmin])
def generate_document_view(request):
    # Взима данните от заявката
    template_name = request.data.get('template_name')  # 'act14_bg.docx'
    context = request.data.get('context')              # {project_name: '...', ...}
    
    # Извиква функция за генериране
    from core.utils.document_generator import generate_document
    file_path = generate_document(template_name, context)
    
    # Създава запис в базата данни
    document = Document.objects.create(
        title=template_name,
        file_docx=file_path
    )
    
    # Връща отговор с линк към файла
    return Response({
        'id': document.id,
        'file_docx': document.file_docx.url,  # /media/generated/act14_bg_20251128.docx
        'created_at': document.created_at
    })
```

#### Стъпка 5: Генериране на Word документ
```
Място: backend/core/utils/document_generator.py
Какво се случва:
1. Отваря шаблон (backend/media/templates/act14_bg.docx)
2. Намира {{placeholder}} маркери в документа
3. Заменя {{project_name}} с "Жилищна сграда"
4. Заменя {{act_date}} с "28.11.2025"
5. Премахва незапълнени {{placeholder}} маркери
6. Записва новия документ в backend/media/generated/
7. Връща пътя до файла
```

#### Стъпка 6: Frontend показва резултата
```
Място: frontend/src/pages/Documents.tsx
Какво се случва:
- Получава отговор от backend
- Добавя документа в списъка на страницата
- Показва линк "📄 DOCX" за изтегляне
- Потребителят кликва и изтегля файла
```

---

## Основни концепции (обяснени просто)

### 1. API (Application Programming Interface)
**Какво е**: Начин две програми да си говорят

**Аналогия**: Като меню в ресторант
- Менюто (API) показва какво можеш да поръчаш
- Ти (Frontend) правиш поръчка
- Кухнята (Backend) приготвя ястието
- Сервитьорът (HTTP) донася резултата

**В нашия проект**:
```
GET  /api/projects/          ← Дай ми списък с проекти
POST /api/projects/          ← Създай нов проект
GET  /api/projects/5/        ← Дай ми проект с ID 5
POST /api/documents/generate/ ← Генерирай документ
```

### 2. REST (REpresentational State Transfer)
**Какво е**: Правила за създаване на API

**Основни HTTP методи**:
- **GET** = Вземи данни (като четене на книга)
- **POST** = Създай нещо ново (като писане на нова страница)
- **PUT** = Обнови съществуващо (като редактиране на страница)
- **DELETE** = Изтрий (като скъсване на страница)

### 3. JSON (JavaScript Object Notation)
**Какво е**: Формат за размяна на данни

**Пример**:
```json
{
  "id": 1,
  "name": "Жилищна сграда",
  "location": "гр. София",
  "status": "active",
  "progress": 75
}
```

Лесно се чете и от хора, и от машини.

### 4. ORM (Object-Relational Mapping)
**Какво е**: Начин да работиш с база данни като с обекти

**Вместо SQL**:
```sql
SELECT * FROM projects WHERE status = 'active';
```

**Пишеш Python**:
```python
projects = Project.objects.filter(status='active')
```

По-лесно, по-безопасно, по-четимо!

### 5. MVC Pattern (Model-View-Controller)
**Какво е**: Начин за организация на кода

```
┌─────────┐
│  Model  │  ← Данни (какво се съхранява)
└────┬────┘
     │
┌────▼────┐
│  View   │  ← Изглед (какво виждаме)
└────┬────┘
     │
┌────▼────┐
│Controller│ ← Логика (какво се случва)
└─────────┘
```

**В Django**:
- **Model** = `backend/core/models/project.py`
- **View** = `backend/core/views/project.py`
- **Template** = HTML (в нашия случай React компонент)

### 6. Single Page Application (SPA)
**Какво е**: Уеб сайт, който не презарежда страницата

**Традиционен сайт**:
- Кликаш линк → Зарежда ЦЯЛА нова страница (бяла мигачка)

**SPA (нашето приложение)**:
- Кликаш линк → Зарежда само нужната част (плавно, без мигачка)
- По-бързо, по-приятно, по-модерно

---

## Какво означават специфичните термини?

| Термин | Значение | Къде се използва |
|--------|----------|------------------|
| **Component** | Част от интерфейса (като LEGO блокче) | React - frontend/src/components/ |
| **Route** | Път в приложението (/login, /projects) | React Router - frontend/src/App.tsx |
| **State** | Текущо състояние на данните | Redux - frontend/src/store/ |
| **Props** | Данни, подавани между компоненти | React компоненти |
| **Hook** | Специална функция в React (useState, useEffect) | Всички React компоненти |
| **Migration** | Промяна в структурата на базата данни | Django - backend/core/migrations/ |
| **Serializer** | Преобразува данни между Python и JSON | DRF - backend/core/serializers.py |
| **ViewSet** | Група от API views за един ресурс | DRF - backend/core/views/ |
| **Middleware** | Код, който се изпълнява при всяка заявка | Django - config/settings.py |

---

## Как да си представим flow-то на данните?

### Сценарий: Виждане на списък с проекти

```
1. Потребител отваря /projects в браузъра
   ↓
2. React Router показва компонент Projects.tsx
   ↓
3. Компонентът се зарежда (useEffect)
   ↓
4. Изпраща GET заявка към /api/projects/
   ↓
5. Django получава заявката във viewset
   ↓
6. Взима проекти от базата данни
   ↓
7. Serializer преобразува в JSON
   ↓
8. Връща JSON отговор към frontend
   ↓
9. React получава данните
   ↓
10. Рендира проектите на екрана (карти с информация)
```

### Визуално представяне:

```
┌──────────────┐
│   Browser    │  "Отвори /projects"
└──────┬───────┘
       │
┌──────▼────────┐
│ React Router  │  "Зареди компонент Projects"
└──────┬────────┘
       │
┌──────▼────────┐
│  Projects.tsx │  "Нужни са ми проекти"
└──────┬────────┘
       │ API Request
┌──────▼────────┐
│  Axios Client │  "GET /api/projects/"
└──────┬────────┘
       │ HTTP
┌──────▼────────┐
│    Django     │  "Обработвам заявката"
└──────┬────────┘
       │
┌──────▼────────┐
│  Database     │  "SELECT * FROM projects"
└──────┬────────┘
       │
┌──────▼────────┐
│  Serializer   │  "Python → JSON"
└──────┬────────┘
       │ JSON Response
┌──────▼────────┐
│ React State   │  "Запазвам данните"
└──────┬────────┘
       │
┌──────▼────────┐
│   Screen      │  "Показвам карти с проекти"
└───────────────┘
```

---

## Следващи стъпки

За да разберете по-подробно всяка част, вижте:

- **[02_BACKEND_ДЕТАЙЛНО](./02_BACKEND_ДЕТАЙЛНО.md)** - Как работи Django backend
- **[03_FRONTEND_ДЕТАЙЛНО](./03_FRONTEND_ДЕТАЙЛНО.md)** - Как работи React frontend
- **[04_ГЕНЕРИРАНЕ_НА_ДОКУМЕНТИ](./04_ГЕНЕРИРАНЕ_НА_ДОКУМЕНТИ.md)** - Как се създават актовете
- **[05_БАЗА_ДАННИ](./05_БАЗА_ДАННИ.md)** - Как се съхраняват данните

---

**Забележка**: Всички обяснения са опростени, за да бъдат разбираеми за начинаещи. За технически детайли вижте другите документи.
